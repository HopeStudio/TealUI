{"version":3,"file":"multiSelect.js","sources":["multiSelect.tsx"],"sourcesContent":["import * as dom from \"web/dom\";\r\nimport Control, { VNode, bind, from } from \"ui/control\";\r\nimport Picker from \"ui/picker\";\r\nimport { ListItem } from \"ui/listBox\";\r\nimport MultiListBox from \"ui/multiListBox\";\r\nimport ComboBox from \"ui/comboBox\";\r\n\r\n/**\r\n * 表示一个选择框。\r\n */\r\nexport default class MultiSelect extends ComboBox {\r\n\r\n    menu: MultiListBox;\r\n\r\n    protected init() {\r\n        super.init();\r\n        this.input.readOnly = true;\r\n        dom.addClass(this.elem, \"x-picker-select\");\r\n    }\r\n\r\n    protected createMenu() {\r\n        const menu = new MultiListBox();\r\n        menu.onSelect = (item, value, e) => {\r\n            if (this.onSelect && this.onSelect(item, e, this) === false) {\r\n                return false;\r\n            }\r\n        };\r\n        menu.onChange = (e) => {\r\n            this.input.value = this.menu.selectedItems.map(item => item.content).join(this.seperator);\r\n            this.onChange && this.onChange(e, this);\r\n        };\r\n        return menu;\r\n    }\r\n\r\n    protected createDropDown() {\r\n        const dropDown = super.createDropDown();\r\n        dropDown.event = \"click\";\r\n        return dropDown;\r\n    }\r\n\r\n    protected handleButtonClick() {\r\n        // FIXME: (this.dropDown as any)._toggle 是什么?\r\n        this.dropDown.toggle((this.dropDown as any)._toggle);\r\n    }\r\n\r\n    /**\r\n     * 选中的第一项。\r\n     */\r\n    get selectedItems() {\r\n        return this.menu.selectedItems;\r\n    }\r\n    set selectedItems(value) {\r\n        this.menu.selectedItems = value;\r\n    }\r\n\r\n    /**\r\n     * 每项之间的分隔符。\r\n     */\r\n    seperator = \",\";\r\n\r\n    get value() {\r\n        return this.menu.selectedItems.map(item=>item.key);\r\n    }\r\n    set value(value) {\r\n        const contents = [];\r\n        this.menu.items.forEach(item=>{\r\n            for(const v of value) {\r\n                if(v == item.key) {\r\n                    item.selected = true;\r\n                    contents.push(item.content);\r\n                    return;\r\n                }\r\n            }\r\n            item.selected = false;\r\n        });\r\n        this.input.value = contents.join(this.seperator);\r\n    }\r\n\r\n    protected updateMenu() {\r\n        \r\n    }\r\n}\r\n"],"mappings":"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"}
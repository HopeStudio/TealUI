{"version":3,"file":"adminApp.js","sources":["adminApp.tsx"],"sourcesContent":["import * as dom from \"web/dom\";\r\nimport Control, { VNode, bind } from \"ui/control\";\r\nimport NavMenu from \"ui/navMenu\";\r\nimport NavTab from \"ui/navTab\";\r\nimport movable from \"web/movable\";\r\nimport \"./adminApp.scss\";\r\nimport { limit } from \"util/function\";\r\n\r\n/**\r\n * 表示一个管理端界面布局。\r\n */\r\nexport default class AdminApp extends Control {\r\n\r\n    @bind logo: string;\r\n    @bind title: string;\r\n    @bind userName: string;\r\n    @bind logount = \"退出\";\r\n    @bind homePage = \"javascript:;\";\r\n    @bind logountUrl = \"javascript://退出登陆\";\r\n\r\n    protected render() {\r\n        return <div class=\"x-adminapp\" style=\"height:300px;\">\r\n            <header class=\"x-adminapp-header\">\r\n                <a href=\"javascript:;\" class=\"x-adminapp-button x-adminapp-collapse\" onClick={this.handleCollapseClick}></a>\r\n                <a href={this.homePage} class=\"x-adminapp-text\"><img src={this.logo} /><span>{this.title}</span></a>\r\n                <div class=\"x-adminapp-right\">\r\n                    <div class=\"x-adminapp-text\">\r\n                        <a href=\"javascript:;\" class=\"x-adminapp-username\">{this.userName}</a>\r\n                    </div>\r\n                    <a class=\"x-adminapp-button x-adminapp-logout\" href={this.logountUrl}>{this.logount}</a>\r\n                </div>\r\n            </header>\r\n            <div class=\"x-adminapp-container\">\r\n                <NavMenu class=\"x-adminapp-sidebar\"></NavMenu>\r\n                <div class=\"x-adminapp-splitter\"></div>\r\n                <div class=\"x-adminapp-main\">\r\n                    <NavTab class=\"x-adminapp-tabs\"></NavTab>\r\n                    <div class=\"x-adminapp-body\">\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    @bind(\".x-adminapp-sidebar\") navMenu: NavMenu;\r\n    @bind(\".x-adminapp-tabs\") navTab: NavTab;\r\n    @bind(\".x-adminapp-main\") main: HTMLElement;\r\n    @bind(\".x-adminapp-body\") body: HTMLElement;\r\n    @bind(\".x-adminapp-splitter\") splitter: HTMLElement;\r\n\r\n    protected init() {\r\n        const self = this;\r\n        dom.setStyle(self.splitter, \"left\", dom.getStyle(this.navMenu.elem, \"width\"));\r\n\r\n        let startWidth: number;\r\n        let startLeft: number;\r\n        movable(this.splitter, {\r\n            moveStart() {\r\n                startWidth = dom.getRect(self.navMenu.elem).width;\r\n                startLeft = dom.computeStyle(self.main, \"left\");\r\n            },\r\n            move(e) {\r\n                let newSidebarWidth = startWidth + this.offsetX!;\r\n                let newLeft = startLeft + this.offsetX!;\r\n\r\n                let delta = 16 * 6 - newSidebarWidth;\r\n                if (delta > 0) {\r\n                    newSidebarWidth += delta;\r\n                    newLeft += delta;\r\n                }\r\n\r\n                delta = newSidebarWidth - self.elem.offsetWidth + 16 * 6;\r\n                if (delta > 0) {\r\n                    newSidebarWidth -= delta;\r\n                    newLeft -= delta;\r\n                }\r\n\r\n                dom.setStyle(self.splitter, \"left\", newSidebarWidth);\r\n                dom.setRect(self.navMenu.elem, { width: newSidebarWidth });\r\n                dom.setStyle(self.main, \"transition\", \"none\");\r\n                dom.setStyle(self.main, \"left\", newLeft);\r\n                setTimeout(() => { dom.setStyle(self.main, \"transition\", \"\"); }, 0);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected handleCollapseClick = limit(() => {\r\n        this.toggleMenuCollapse();\r\n    }, 400);\r\n\r\n    /**\r\n     * 切换菜单的折叠效果。\r\n     */\r\n    toggleMenuCollapse() {\r\n        const collapsed = !this.navMenu.collapsed;\r\n        this.navMenu.toggleCollapse();\r\n        dom.toggleClass(this.elem, \"x-adminapp-collapsed\", collapsed);\r\n        dom.toggle(this.splitter, !collapsed);\r\n    }\r\n\r\n}\r\n"],"mappings":"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"}
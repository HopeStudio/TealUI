{"version":3,"file":"messageBox.js","sources":["messageBox.tsx"],"sourcesContent":["import * as dom from \"web/dom\";\r\nimport Control, { VNode, bind } from \"ui/control\";\r\nimport Dialog from \"ui/dialog\";\r\nimport \"typo/util\";\r\nimport \"ui/textBox/textBox.scss\";\r\nimport \"ui/button/button.scss\";\r\nimport \"./messageBox.scss\";\r\n\r\n/**\r\n * 表示一个消息框。\r\n */\r\nexport default class MessageBox extends Dialog {\r\n\r\n    /**\r\n     * 当点击关闭按钮后执行。\r\n     */\r\n    protected handleCloseClick() {\r\n        this.cancel();\r\n    }\r\n\r\n    /**\r\n     * 点击确定按钮。\r\n     */\r\n    ok() {\r\n        if (!this.onOk || this.onOk() !== false) {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 点击取消按钮。\r\n     */\r\n    cancel() {\r\n        if (!this.onCancel || this.onCancel() !== false) {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 点击确定事件。\r\n     */\r\n    onOk: () => boolean | void;\r\n\r\n    /**\r\n     * 点击取消事件。\r\n     */\r\n    onCancel: () => boolean | void;\r\n\r\n    /**\r\n     * 图标。\r\n     */\r\n    set icon(value: \"error\" | \"warning\" | \"info\" | \"success\" | \"confirm\" | null) {\r\n        let icon = dom.prev(this.body, \".x-panel-icon\");\r\n        if (value) {\r\n            (icon || (icon = dom.before(this.body, \"<span/>\") as HTMLElement)).className = `x-icon x-panel-icon x-panel-icon-${value}`;\r\n        } else {\r\n            dom.remove(icon);\r\n        }\r\n    }\r\n\r\n    /**\r\n\t * 按钮。\r\n\t */\r\n    set buttons(value: { [content: string]: boolean | (() => void) } | null) {\r\n        let buttons = dom.next(this.body, \".x-panel-buttons\");\r\n        if (value === null) {\r\n            dom.remove(buttons);\r\n        } else {\r\n            if (buttons) {\r\n                buttons.innerHTML = \"\";\r\n            } else {\r\n                buttons = dom.append(dom.find(this.elem, \".x-panel\")!, `<div class=\"x-panel-buttons\"></div>`) as HTMLElement;\r\n            }\r\n            for (const key in value) {\r\n                const click = value[key];\r\n                const button = dom.append(buttons, `<button class=\"x-button\"></button>`) as HTMLButtonElement;\r\n                dom.setText(button, key);\r\n                if (click === true) {\r\n                    dom.addClass(button, \"x-button-primary\");\r\n                }\r\n                dom.on(button, \"click\", click === true ? this.ok : click === false ? this.cancel : click, this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 主按钮。\r\n     */\r\n    set primaryButton(value: number) {\r\n        const old = dom.find(this.elem, \".x-dialog-buttons > .x-button-primary\");\r\n        if (old) {\r\n            dom.removeClass(old, \"x-button-primary\");\r\n        }\r\n        const btn = dom.find(this.elem, `.x-dialog-buttons > .x-button:nth-child(${value + 1})`);\r\n        if (btn) {\r\n            dom.addClass(btn, \"x-button-primary\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示一个消息框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param buttons 消息框的按钮。\r\n     * @param icon 消息框的图标。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static show(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"提示\", buttons: MessageBox[\"buttons\"] = { 确定: true }, icon?: MessageBox[\"icon\"], onOk?: MessageBox[\"onOk\"], onCancel?: MessageBox[\"onCancel\"]) {\r\n        const r = new MessageBox();\r\n        r.content = content;\r\n        r.title = title;\r\n        r.draggable = true;\r\n        r.buttons = buttons;\r\n        r.icon = icon!;\r\n        r.onOk = onOk!;\r\n        r.onCancel = onCancel!;\r\n        r.show();\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * 显示一个警告框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     */\r\n    static alert(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"警告\", onOk?: MessageBox[\"onOk\"]) {\r\n        return MessageBox.show(content, title, undefined, \"warning\", onOk, onOk);\r\n    }\r\n\r\n    /**\r\n     * 显示一个确认框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static confirm(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"确认\", onOk?: MessageBox[\"onOk\"], onCancel?: MessageBox[\"onCancel\"]) {\r\n        const r = MessageBox.show(content, title, {\r\n            \"确定\": true,\r\n            \"取消\": false\r\n        }, \"confirm\", onOk, onCancel);\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * 显示一个输入框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static prompt(content: string, title: MessageBox[\"title\"] = \"请输入\", onOk?: (value: string) => boolean | void, onCancel?: MessageBox[\"onCancel\"]) {\r\n        const r = MessageBox.show(`<input type=\"text\" class=\"x-textbox x-block\">`, title, {\r\n            \"确定\": true,\r\n            \"取消\": false\r\n        }, undefined, () => {\r\n            onOk && onOk.call(r, (r.find(\".x-textbox\") as HTMLInputElement).value);\r\n        }, onCancel);\r\n        (r.find(\".x-textbox\") as HTMLInputElement).value = content;\r\n        return r;\r\n    }\r\n\r\n}\r\n"],"mappings":"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"}
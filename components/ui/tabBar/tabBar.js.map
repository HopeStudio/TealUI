{"version":3,"file":"tabBar.js","sources":["tabBar.tsx"],"sourcesContent":["import * as dom from \"web/dom\";\r\nimport { scrollSize, scrollBy, scrollIntoViewIfNeeded } from \"web/scroll\";\r\nimport Control, { VNode, bind } from \"ui/control\";\r\nimport \"typo/icon/icon.scss\";\r\nimport \"typo/close/close.scss\";\r\nimport \"./tabBar.scss\";\r\n\r\n/**\r\n * 表示一个标签条。\r\n */\r\nexport default class TabBar extends Control {\r\n\r\n    /**\r\n     * 是否隐藏最后一个标签页的关闭按钮。\r\n     */\r\n    hideLastTabClose: boolean;\r\n\r\n    /**\r\n     * 翻页按钮每次滚动距离。\r\n     * @default 120\r\n     */\r\n    scrollDelta: number;\r\n\r\n    /**\r\n     * 添加标签事件。\r\n     * @param tab 标签。\r\n     * @param sender 事件源。\r\n     */\r\n    onAddTab: (tab: HTMLElement, sender: this) => void;\r\n\r\n    /**\r\n     * 移除标签事件。\r\n     * @param tab 标签。\r\n     * @param sender 事件源。\r\n     */\r\n    onRemoveTab: (tab: HTMLElement, sender: this) => void;\r\n\r\n    /**\r\n     * 激活标签事件。\r\n     * @param tab 标签。\r\n     * @param sender 事件源。\r\n     */\r\n    onActiveTab: (tab: HTMLElement, sender: this) => void;\r\n\r\n    protected render() {\r\n        return <nav class=\"x-tabbar\">\r\n            <a href=\"javascript:;\" class=\"x-icon x-tabbar-left\">⮜</a>\r\n            <a href=\"javascript:;\" class=\"x-icon x-tabbar-right\">⮞</a>\r\n            <div class=\"x-tabbar-body\">\r\n                <ul role=\"tablist\"></ul>\r\n                <div class=\"x-tabbar-bar\"></div>\r\n            </div>\r\n        </nav>;\r\n    }\r\n\r\n    /**\r\n     * 向左滚动按钮。\r\n     */\r\n    @bind(\".x-tabbar-left\") scrollLeftButton: HTMLElement;\r\n\r\n    /**\r\n     * 向右滚动按钮。\r\n     */\r\n    @bind(\".x-tabbar-right\") scrollRightButton: HTMLElement;\r\n\r\n    /**\r\n     * 主体。\r\n     */\r\n    @bind(\".x-tabbar-body\") body: HTMLElement;\r\n\r\n    /**\r\n     * 标签页容器。\r\n     */\r\n    @bind(\".x-tabbar-body ul\") container: HTMLElement;\r\n\r\n    /**\r\n     * 指示当前激活标签页的条。\r\n     */\r\n    @bind(\".x-tabbar-bar\") activeBar: HTMLElement;\r\n\r\n    protected init() {\r\n        dom.on(this.elem, \"pointerup\", \"li\", this.handleItemPointerUp, this);\r\n        dom.on(this.elem, \"click\", \"li\", this.handleItemClick, this);\r\n        dom.on(this.body, \"scroll\", this.handleScroll, this);\r\n        dom.on(this.elem, \"mousewheel\", this.handleMouseWheel, this);\r\n        // FIXME: 改为长按一直触发。\r\n        dom.on(this.scrollLeftButton, \"click\", this.handleScrollLeftPointerDown, this);\r\n        dom.on(this.scrollRightButton, \"click\", this.handleScrollRightPointerDown, this);\r\n        dom.on(window, \"resize\", () => { this.realign(); this.realignActiveBar(this.selectedTab); });\r\n    }\r\n\r\n    /**\r\n     * 处理指针在标签项松开事件。\r\n     * @param e 事件。\r\n     * @param tab 当前标签项。\r\n     */\r\n    protected handleItemPointerUp(e: MouseEvent, tab: HTMLElement) {\r\n        if (e.button === 1) {\r\n            if (this.hideLastTabClose && dom.first(this.container) === dom.last(this.container)) {\r\n                return;\r\n            }\r\n            this.removeTab(tab);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理指针点击事件。\r\n     * @param e 事件。\r\n     * @param tab 当前标签项。\r\n     */\r\n    protected handleItemClick(e: MouseEvent, tab: HTMLElement) {\r\n        if (dom.hasClass(e.target as HTMLElement, \"x-close\")) {\r\n            this.removeTab(tab);\r\n        } else {\r\n            this.activeTab(tab);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理滚轮事件。\r\n     * @param e 事件。\r\n     */\r\n    protected handleMouseWheel(e: WheelEvent) {\r\n        e.preventDefault();\r\n        scrollBy(this.body, { x: -e.wheelDelta }, this.duration);\r\n    }\r\n\r\n    /**\r\n     * 处理左滚按住事件。\r\n     */\r\n    protected handleScrollLeftPointerDown() {\r\n        scrollBy(this.body, { x: -this.scrollDelta }, this.duration);\r\n    }\r\n\r\n    /**\r\n     * 处理右滚按住事件。\r\n     */\r\n    protected handleScrollRightPointerDown() {\r\n        scrollBy(this.body, { x: this.scrollDelta }, this.duration);\r\n    }\r\n\r\n    /**\r\n     * 处理滚动事件。\r\n     */\r\n    protected handleScroll() {\r\n        dom.toggleClass(this.scrollLeftButton, \"x-tabbar-disabled\", this.body.scrollLeft === 0);\r\n        dom.toggleClass(this.scrollRightButton, \"x-tabbar-disabled\", this.body.scrollLeft + this.body.offsetWidth >= this.body.scrollWidth);\r\n    }\r\n\r\n    /**\r\n     * 添加一个标签。\r\n     * @param content 标签名。\r\n     * @param active 标签是否默认激活。\r\n     * @return 返回新建的标签项。\r\n     */\r\n    addTab(content: string, active = true, duration?: number) {\r\n        const tab = dom.append(this.container, `<li role=\"tab\" style=\"width:0\"><button class=\"x-close x-icon\" title=\"关闭\" aria-label=\"关闭\">✖</button><a href=\"javascript:;\"></a></li>`) as HTMLElement;\r\n        const body = tab.lastChild as HTMLElement;\r\n        body.title = body.textContent = content;\r\n        this.realign(duration);\r\n        this.onAddTab && this.onAddTab(tab, this);\r\n        if (active) {\r\n            this.activeTab(tab, duration);\r\n        } else {\r\n            this.tabHistory.push(tab);\r\n        }\r\n        return tab;\r\n    }\r\n\r\n    /**\r\n     * 删除一个标签。\r\n     * @param tab 标签。\r\n     * @param active 是否重新激活最后打开的标签。\r\n     */\r\n    removeTab(tab: HTMLElement, active = true, duration?: number) {\r\n        const selectedTab = this.selectedTab;\r\n        const needReactive = active && selectedTab === tab;\r\n        // 从历史纪录删除。\r\n        let p: number;\r\n        while ((p = this.tabHistory.indexOf(tab)) >= 0) this.tabHistory.splice(p, 1);\r\n        this.realign(duration, tab);\r\n        this.onRemoveTab && this.onRemoveTab(tab, this);\r\n        if (needReactive) {\r\n            this.activeTab(this.popTabHistory(), duration);\r\n        } else {\r\n            this.realignActiveBar(selectedTab, duration);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 激活一个标签。\r\n     * @param tab 标签。\r\n     */\r\n    activeTab(tab: HTMLElement | null | undefined, duration?: number) {\r\n        const selectedTab = this.selectedTab;\r\n        if (selectedTab === tab) {\r\n            return;\r\n        }\r\n        if (selectedTab) {\r\n            dom.removeClass(selectedTab, \"x-tabbar-active\");\r\n            selectedTab.setAttribute(\"aria-selected\", \"false\");\r\n        }\r\n        if (tab) {\r\n            dom.addClass(tab, \"x-tabbar-active\");\r\n            tab.setAttribute(\"aria-selected\", \"true\");\r\n            this.tabHistory.push(tab);\r\n            this.onActiveTab && this.onActiveTab(tab, this);\r\n        }\r\n        this.realignActiveBar(tab, duration);\r\n    }\r\n\r\n    /**\r\n     * 标签浏览历史。\r\n     */\r\n    tabHistory: HTMLElement[] = [];\r\n\r\n    /**\r\n     * 弹出最后一次标签访问记录。\r\n     */\r\n    popTabHistory() {\r\n        return this.tabHistory.pop();\r\n    }\r\n\r\n    /**\r\n     * 激活的标签页。\r\n     */\r\n    get selectedTab() {\r\n        return this.find(\".x-tabbar-active\") as HTMLElement | null;\r\n    }\r\n    set selectedTab(value) {\r\n        this.activeTab(value, 0);\r\n    }\r\n\r\n    /**\r\n     * 根据标签页的数目重新调整标签页大小。\r\n     * @param remove 需要渐变隐藏的标签。\r\n     */\r\n    realign(duration = this.duration, remove?: HTMLElement) {\r\n        const tabCount = this.container.childNodes.length + (remove ? -1 : 0);\r\n        const containerWidth = this.body.offsetWidth;\r\n        if (containerWidth) {\r\n            const maxTabWidth = containerWidth / tabCount;\r\n            let totalWidth = 0;\r\n            let leftCount = tabCount;\r\n            for (let node = this.container.firstChild as HTMLElement; node; node = node.nextSibling as HTMLElement) {\r\n                if (node === remove) {\r\n                    dom.animate(node, { width: 0, minWidth: 0, opacity: 0 }, () => {\r\n                        dom.remove(node);\r\n                        node.style.minWidth = \"\";\r\n                    }, duration);\r\n                } else {\r\n                    const tabWidth = node === remove ? 0 : Math.max(Math.min(maxTabWidth, dom.computeStyle(node, \"maxWidth\")), dom.computeStyle(node, \"minWidth\"));\r\n                    dom.animate(node, { width: tabWidth }, () => {\r\n                        if (--leftCount <= 0) {\r\n                            this.activeTab(this.selectedTab, duration);\r\n                        }\r\n                    }, duration);\r\n                    totalWidth += tabWidth + dom.computeStyle(node, \"marginLeft\", \"marginRight\");\r\n                }\r\n            }\r\n            dom.toggleClass(this.elem, \"x-tabbar-overflow\", totalWidth >= containerWidth);\r\n        }\r\n\r\n        // 隐藏最后一个标签的关闭按钮。\r\n        if (this.hideLastTabClose) {\r\n            this.query(\".x-close\").forEach((c: HTMLElement) => {\r\n                dom.toggle(c, tabCount > 1, \"opacity\");\r\n            });\r\n        }\r\n    }\r\n\r\n    protected realignActiveBar(tab: HTMLElement | null | undefined, duration?: number) {\r\n        let totalWidth = 0;\r\n        for (let node = this.container.firstChild as HTMLElement; node; node = node.nextSibling as HTMLElement) {\r\n            const tabWidth = parseFloat(node.style.width!) || 0;\r\n            if (node === tab) {\r\n                dom.animate(this.activeBar, { width: tabWidth, left: totalWidth });\r\n                scrollIntoViewIfNeeded(node, this.body, duration);\r\n                break;\r\n            }\r\n            if (tabWidth) {\r\n                totalWidth += tabWidth + dom.computeStyle(node, \"marginLeft\", \"marginRight\");\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nTabBar.prototype.scrollDelta = 100;\r\n"],"mappings":"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"}
{"version":3,"file":"chineseId.js","sources":["chineseId.ts"],"sourcesContent":["import { compareYear } from \"util/date\";\r\n\r\n/**\r\n * 解析 18 位中国身份证号的信息。\r\n * @param idNumber 要解析的身份证号。\r\n * @return 返回一个对象，包含以下字段：\r\n * - valid：身份证是否合法。\r\n * - province：省份（自治区、直辖市）编码。\r\n * - city：地级市（州、盟）编码。\r\n * - county：县级市（区、旗）编码。\r\n * - birthday：生日。\r\n * - sex：性别。true 表示男, false 表示女。\r\n * @desc 本函数只验证身份证的数值特征，并不能判定身份证是否真实存在。\r\n * @example parseChineseId(\"152500198909267865\")\r\n */\r\nexport function parseChineseId(idNumber: string) {\r\n\r\n    const province = +idNumber.substr(0, 2);\r\n    const city = +idNumber.substr(2, 2);\r\n    const county = +idNumber.substr(4, 2);\r\n\r\n    // 身份证 6 - 13 表示生日。\r\n    const birthdayYear = +idNumber.substr(6, 4);\r\n    const birthdayMonth = +idNumber.substr(10, 2) - 1;\r\n    const birthdayDay = +idNumber.substr(12, 2);\r\n    const birthday = new Date(birthdayYear, birthdayMonth, birthdayDay);\r\n\r\n    // 身份证 17 表示检验码。\r\n    let valid = province > 10 && city >= 0 && county >= 0 &&\r\n        birthday.getFullYear() === birthdayYear &&\r\n        birthday.getMonth() === birthdayMonth &&\r\n        birthday.getDate() === birthdayDay;\r\n    if (valid) {\r\n        let code = 0;\r\n        for (let i = 0; i < 18; i++) {\r\n            const bit = idNumber.charCodeAt(17 - i);\r\n            code += ((1 << i) % 11) * (!i && (bit | 32) === 120 /*x*/ ? 10 : bit > 47 && bit < 58 ? bit - 48 : NaN);\r\n        }\r\n        valid = code % 11 === 1;\r\n    }\r\n\r\n    // 身份证 16 表示性别。\r\n    return {\r\n\r\n        /**\r\n         * 判断身份证是否合法。\r\n         */\r\n        valid,\r\n\r\n        /**\r\n         * 获取身份证的省份（自治区、直辖市）编码。\r\n         */\r\n        province,\r\n\r\n        /**\r\n         * 获取身份证的地级市（州、盟）编码。\r\n         */\r\n        city,\r\n\r\n        /**\r\n         * 获取身份证的县级市（区、旗）编码。\r\n         */\r\n        county,\r\n\r\n        /**\r\n         * 获取身份证的生日。\r\n         */\r\n        birthday,\r\n\r\n        /**\r\n         * 获取身份证的性别。true 表示男, false 表示女。\r\n         */\r\n        sex: idNumber.charCodeAt(16) % 2 === 1\r\n\r\n    };\r\n}\r\n\r\n/**\r\n * 从 18 位身份证号提取周岁。\r\n * @param idNumber 要解析的身份证号。\r\n * @param now 当前时间。\r\n * @return 返回周岁。如果无法读取身份证号的生日信息则返回 NaN。\r\n * @example getAgeFromChineseId(\"152500198909267865\")\r\n */\r\nexport function getAgeFromChineseId(idNumber: string, now = new Date()) {\r\n    return compareYear(now, new Date(idNumber.slice(6, 14).replace(/(\\d{4})(\\d\\d)(\\d\\d)/, \"$1/$2/$3\")));\r\n}\r\n"],"mappings":";;;IAEA;;;;;;;;;;;;OAYG;IACH,wBAA+B,QAAgB;QAE3C,IAAM,QAAQ,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACxC,IAAM,IAAI,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACpC,IAAM,MAAM,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAEtC,mBAAmB;QACnB,IAAM,YAAY,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC5C,IAAM,aAAa,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAClD,IAAM,WAAW,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QAC5C,IAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,YAAY,EAAE,aAAa,EAAE,WAAW,CAAC,CAAC;QAEpE,gBAAgB;QAChB,IAAI,KAAK,GAAG,QAAQ,GAAG,EAAE,IAAI,IAAI,IAAI,CAAC,IAAI,MAAM,IAAI,CAAC;YACjD,QAAQ,CAAC,WAAW,EAAE,KAAK,YAAY;YACvC,QAAQ,CAAC,QAAQ,EAAE,KAAK,aAAa;YACrC,QAAQ,CAAC,OAAO,EAAE,KAAK,WAAW,CAAC;QACvC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACR,IAAI,IAAI,GAAG,CAAC,CAAC;YACb,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC1B,IAAM,GAAG,GAAG,QAAQ,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxC,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YAC5G,CAAC;YACD,KAAK,GAAG,IAAI,GAAG,EAAE,KAAK,CAAC,CAAC;QAC5B,CAAC;QAED,eAAe;QACf,MAAM,CAAC;YAEH;;eAEG;YACH,KAAK,OAAA;YAEL;;eAEG;YACH,QAAQ,UAAA;YAER;;eAEG;YACH,IAAI,MAAA;YAEJ;;eAEG;YACH,MAAM,QAAA;YAEN;;eAEG;YACH,QAAQ,UAAA;YAER;;eAEG;YACH,GAAG,EAAE,QAAQ,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC;SAEzC,CAAC;IACN,CAAC;IA5DD,wCA4DC;IAED;;;;;;OAMG;IACH,6BAAoC,QAAgB,EAAE,GAAgB;QAAhB,oBAAA,EAAA,UAAU,IAAI,EAAE;QAClE,MAAM,CAAC,kBAAW,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,qBAAqB,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;IACxG,CAAC;IAFD,kDAEC"}
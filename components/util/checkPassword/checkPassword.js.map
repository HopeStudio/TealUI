{"version":3,"file":"checkPassword.js","sources":["checkPassword.ts"],"sourcesContent":["/**\r\n * 测试密码的复杂度。\r\n * @param value 要测试的密码。\r\n * @return 返回一个整数。值越大表示复杂度越高。具体范围如下：\r\n * - < 0：太简单（如 123456）。\r\n * - = 0：简单（如 901206）。\r\n * - \\> 0：复杂（如 abc123）。\r\n * - \\>= 3：很复杂（如 a1b2c3）。\r\n * @example checkPassword(\"123456\") // -1\r\n */\r\nexport default function checkPassword(value: string) {\r\n    value = value.replace(/1q2w(?:3e(?:4r(?:5t)?)?)?/, \"1\")\r\n        .replace(/(?:qwe(?:rty(?:ui)?)?)+/, \"q\")\r\n        .replace(/(?:asd(?:fgh(?:jk)?)?)+/, \"a\")\r\n        .replace(/1?qaz(?:1?qaz|2?wsx)?/, \"q\")\r\n        .replace(/(?:147|258|369)+/, \"1\")\r\n        .replace(/[a-zA-Z]+123/, \"1\")\r\n        .replace(/(?:123){2,}/, \"1\")\r\n        .replace(/7891?0/, \"789\")\r\n        .replace(/\\.1415/, \"5\");\r\n    let complexLevel = Math.floor(value.length / 10);\r\n    let equalCount = 0;\r\n    let chainCount = 0;\r\n    let oldCharCode: number | undefined;\r\n    let oldCharType: 0 | 1 | 2 | 3 | undefined;\r\n    for (let i = 0; i < value.length; i++) {\r\n        const newCharCode = value.charCodeAt(i);\r\n        const newCharType = newCharCode >= 48 && newCharCode <= 57 ? 0 : newCharCode >= 97 && newCharCode <= 122 ? 1 : newCharCode >= 65 && newCharCode <= 90 ? 2 : 3;\r\n        if (i) {\r\n            if (oldCharType !== newCharType) {\r\n                complexLevel++;\r\n            } else if (Math.abs(newCharCode - oldCharCode!) <= 1) {\r\n                if (newCharCode === oldCharCode) {\r\n                    equalCount++;\r\n                } else {\r\n                    chainCount++;\r\n                }\r\n            }\r\n        }\r\n        oldCharCode = newCharCode;\r\n        oldCharType = newCharType;\r\n    }\r\n    return complexLevel - (value.length - equalCount <= 1 ? 2 : value.length - chainCount <= 1 ? 1 : 0);\r\n}\r\n"],"mappings":";;;IAAA;;;;;;;;;OASG;IACH,uBAAsC,KAAa;QAC/C,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,2BAA2B,EAAE,GAAG,CAAC;aAClD,OAAO,CAAC,yBAAyB,EAAE,GAAG,CAAC;aACvC,OAAO,CAAC,yBAAyB,EAAE,GAAG,CAAC;aACvC,OAAO,CAAC,uBAAuB,EAAE,GAAG,CAAC;aACrC,OAAO,CAAC,kBAAkB,EAAE,GAAG,CAAC;aAChC,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC;aAC5B,OAAO,CAAC,aAAa,EAAE,GAAG,CAAC;aAC3B,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC;aACxB,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QAC5B,IAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;QACjD,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,IAAI,WAA+B,CAAC;QACpC,IAAI,WAAsC,CAAC;QAC3C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACpC,IAAM,WAAW,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACxC,IAAM,WAAW,GAAG,WAAW,IAAI,EAAE,IAAI,WAAW,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,IAAI,EAAE,IAAI,WAAW,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,IAAI,EAAE,IAAI,WAAW,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC9J,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACJ,EAAE,CAAC,CAAC,WAAW,KAAK,WAAW,CAAC,CAAC,CAAC;oBAC9B,YAAY,EAAE,CAAC;gBACnB,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,WAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBACnD,EAAE,CAAC,CAAC,WAAW,KAAK,WAAW,CAAC,CAAC,CAAC;wBAC9B,UAAU,EAAE,CAAC;oBACjB,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACJ,UAAU,EAAE,CAAC;oBACjB,CAAC;gBACL,CAAC;YACL,CAAC;YACD,WAAW,GAAG,WAAW,CAAC;YAC1B,WAAW,GAAG,WAAW,CAAC;QAC9B,CAAC;QACD,MAAM,CAAC,YAAY,GAAG,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACxG,CAAC;IAjCD,gCAiCC"}
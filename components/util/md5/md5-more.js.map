{"version":3,"file":"md5-more.js","sources":["md5-more.ts"],"sourcesContent":["import { md5Core, md5Binary, stringToBinary, binaryToString } from \"./md5\";\r\n\r\n/**\r\n * 计算字符串的 MD5-Base64 值。\r\n * @param value 要计算的字符串。\r\n * @return 返回计算后的字符串。\r\n * @example md5Base64(\"abc\") // \"kAFQmDzST7DWlj99KOF/cg\"\r\n */\r\nexport function md5Base64(value: string) {\r\n    return binaryToBase64(md5Binary(value));\r\n}\r\n\r\n/**\r\n * 使用 Base64 编码字节数组。\r\n * @param value 要编码的字节数组。\r\n * @param padding 用于补齐编码的字符。\r\n * @return 返回编码后字符串。\r\n * @internal\r\n */\r\nexport function binaryToBase64(value: number[], padding = \"\") {\r\n    let r = \"\";\r\n    for (let i = 0; i < value.length * 4; i += 3) {\r\n        const triplet = (value[i >> 2] >> i % 4 * 8 & 255) << 16 | (value[i + 1 >> 2] >> (i + 1) % 4 * 8 & 0xff) << 8 | value[i + 2 >> 2] >> (i + 2) % 4 * 8 & 0xff;\r\n        for (let j = 0; j < 4; j++) {\r\n            r += i * 8 + j * 6 > value.length * 32 ? padding : (\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt((triplet >> 6 * (3 - j)) & 0x3F));\r\n        }\r\n    }\r\n    return r;\r\n}\r\n\r\n/**\r\n * 计算字符串的 HMAC-MD5 值。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @return 返回计算后的字符串。\r\n * @example hmacMd5(\"abc\", \"key\") // \"d2fe98063f876b03193afb49b4979591\"\r\n */\r\nexport function hmacMD5(value: string, key: string) {\r\n    return binaryToString(hmacBinary(value, key));\r\n}\r\n\r\n/**\r\n * 计算字符串的 HMAC-MD5-Base64 值。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @return 返回加密后的字符串，其中只包含小写字母。\r\n * @example hmacMD5Base64(\"abc\", \"key\") // \"0v6YBj+HawMZOvtJtJeVkQ\"\r\n */\r\nexport function hmacMD5Base64(value: string, key: string) {\r\n    return binaryToBase64(hmacBinary(value, key));\r\n}\r\n\r\n/**\r\n * 解码函数。\r\n */\r\ndeclare function unescape(value: string): string;\r\n\r\n/**\r\n * 计算字符串的 HMAC-MD5-Base64 值并返回字节数组。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @return 返回字节数组。\r\n * @internal\r\n */\r\nexport function hmacBinary(value: string, key: string) {\r\n    value = unescape(encodeURIComponent(value));\r\n    key = unescape(encodeURIComponent(key));\r\n    let bkey = stringToBinary(key);\r\n    if (bkey.length > 16) bkey = md5Core(bkey, key.length * 8);\r\n\r\n    const ipad: number[] = [];\r\n    const opad: number[] = [];\r\n    for (let i = 0; i < 16; i++) {\r\n        ipad[i] = bkey[i] ^ 0x36363636;\r\n        opad[i] = bkey[i] ^ 0x5C5C5C5C;\r\n    }\r\n\r\n    return md5Core(opad.concat(md5Core(ipad.concat(stringToBinary(value)), 512 + value.length * 8)), 512 + 128);\r\n}\r\n"],"mappings":"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"}
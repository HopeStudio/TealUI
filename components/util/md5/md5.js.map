{"version":3,"file":"md5.js","sources":["md5.ts"],"sourcesContent":["/**\r\n * 计算字符串的 MD5 值。\r\n * @param value 要计算的字符串。\r\n * @return 返回 32 位全小写 MD5 值。\r\n * @example md5(\"a\") // \"0cc175b9c0f1b6a831c399e269772661\"\r\n */\r\nexport default function md5(value: string) {\r\n    return binaryToString(md5Binary(value));\r\n}\r\n\r\n/**\r\n * 计算字符串的 MD5 值并返回字节数组。\r\n * @param value 要加密的字符串。\r\n * @return 返回加密后的字节数组。\r\n * @internal\r\n */\r\nexport function md5Binary(value: string) {\r\n    value = unescape(encodeURIComponent(value));\r\n    return md5Core(stringToBinary(value), value.length * 8);\r\n}\r\n\r\ndeclare function unescape(value: string): string;\r\n\r\n/**\r\n * 将 ASCII 字符转为字节数组。\r\n * @param value 相关的文本。\r\n * @return 返回字节数组。\r\n * @desc 如果字符编码大于 255 则高位会被截断。\r\n * @internal\r\n */\r\nexport function stringToBinary(value: string) {\r\n    const len = value.length * 8;\r\n    const r: number[] = [];\r\n    for (let i = 0; i < len; i += 8) {\r\n        r[i >> 5] |= (value.charCodeAt(i / 8) & 0xff) << (i % 32);\r\n    }\r\n    return r;\r\n}\r\n\r\n/**\r\n * 将字节数组转为 ASCII 字符。\r\n * @param value 相关的字节数组。\r\n * @return 返回字符串。\r\n * @desc 如果字符编码大于 255 则高位会被截断。\r\n * @internal\r\n */\r\nexport function binaryToString(value: number[]) {\r\n    const len = value.length * 32;\r\n    let r = \"\";\r\n    for (let i = 0; i < len; i += 8) {\r\n        const t = (value[i >> 5] >>> (i % 32)) & 0xFF;\r\n        r += hexChars[(t >>> 4) & 0x0F] + hexChars[t & 0x0F];\r\n    }\r\n    return r;\r\n}\r\n\r\n/**\r\n * 编码使用的字符集。\r\n * @desc 如果需要更改加密返回的字母大小写可更改此字段。\r\n * @internal\r\n */\r\nexport const hexChars = \"0123456789abcdef\";\r\n\r\n/**\r\n * 执行 MD5 加密算法。\r\n * @param value 要计算的字节数组。\r\n * @param length 总位数。\r\n * @return 返回已加密的字节数组。\r\n * @internal\r\n */\r\nexport function md5Core(value: number[], count: number) {\r\n    const fns = [\r\n        (b: number, c: number, d: number) => b & c | ~b & d,\r\n        (b: number, c: number, d: number) => b & d | c & ~d,\r\n        (b: number, c: number, d: number) => b ^ c ^ d,\r\n        (b: number, c: number, d: number) => c ^ (b | ~d)\r\n    ];\r\n    const pss = [\r\n        [7, 12, 17, 22],\r\n        [5, 9, 14, 20],\r\n        [4, 11, 16, 23],\r\n        [6, 10, 15, 21],\r\n    ];\r\n    // 对齐字符串。\r\n    value[count >> 5] |= 0x80 << (count % 32);\r\n    value[(((count + 64) >>> 9) << 4) + 14] = count;\r\n    let a = 1732584193;\r\n    let b = -271733879;\r\n    let c = -1732584194;\r\n    let d = 271733878;\r\n    let procIndex = 0;\r\n    for (let i = 0; i < value.length; i += 16) {\r\n        const oldA = a;\r\n        const oldB = b;\r\n        const oldC = c;\r\n        const oldD = d;\r\n        const proc = (j0: number, j1: number, j2: number, j3: number, ts0: number, ts1: number, ts2: number, ts3: number) => {\r\n            const fn = fns[procIndex];\r\n            const ps = pss[procIndex];\r\n            a = combine(fn(b, c, d), a, b, value[i + j0], ps[0], ts0);\r\n            d = combine(fn(a, b, c), d, a, value[i + j1], ps[1], ts1);\r\n            c = combine(fn(d, a, b), c, d, value[i + j2], ps[2], ts2);\r\n            b = combine(fn(c, d, a), b, c, value[i + j3], ps[3], ts3);\r\n        };\r\n\r\n        procIndex = 0;\r\n        proc(0, 1, 2, 3, -680876936, -389564586, 606105819, -1044525330);\r\n        proc(4, 5, 6, 7, -176418897, 1200080426, -1473231341, -45705983);\r\n        proc(8, 9, 10, 11, 1770035416, -1958414417, -42063, -1990404162);\r\n        proc(12, 13, 14, 15, 1804603682, -40341101, -1502002290, 1236535329);\r\n\r\n        procIndex = 1;\r\n        proc(1, 6, 11, 0, -165796510, -1069501632, 643717713, -373897302);\r\n        proc(5, 10, 15, 4, -701558691, 38016083, -660478335, -405537848);\r\n        proc(9, 14, 3, 8, 568446438, -1019803690, -187363961, 1163531501);\r\n        proc(13, 2, 7, 12, -1444681467, -51403784, 1735328473, -1926607734);\r\n\r\n        procIndex = 2;\r\n        proc(5, 8, 11, 14, -378558, -2022574463, 1839030562, -35309556);\r\n        proc(1, 4, 7, 10, -1530992060, 1272893353, -155497632, -1094730640);\r\n        proc(13, 0, 3, 6, 681279174, -358537222, -722521979, 76029189);\r\n        proc(9, 12, 15, 2, -640364487, -421815835, 530742520, -995338651);\r\n\r\n        procIndex = 3;\r\n        proc(0, 7, 14, 5, -198630844, 1126891415, -1416354905, -57434055);\r\n        proc(12, 3, 10, 1, 1700485571, -1894986606, -1051523, -2054922799);\r\n        proc(8, 15, 6, 13, 1873313359, -30611744, -1560198380, 1309151649);\r\n        proc(4, 11, 2, 9, -145523070, -1120210379, 718787259, -343485551);\r\n\r\n        a = safeAdd(a, oldA);\r\n        b = safeAdd(b, oldB);\r\n        c = safeAdd(c, oldC);\r\n        d = safeAdd(d, oldD);\r\n    }\r\n    return [a, b, c, d];\r\n}\r\n\r\nfunction safeAdd(x: number, y: number) {\r\n    const lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n    return ((x >> 16) + (y >> 16) + (lsw >> 16)) << 16 | lsw & 0xFFFF;\r\n}\r\n\r\nfunction combine(q: number, a: number, b: number, x: number, str: number, t: number) {\r\n    const num = safeAdd(safeAdd(a, q), safeAdd(x, t));\r\n    return safeAdd((num << str) | (num >>> (32 - str)), b);\r\n}\r\n"],"mappings":"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"}